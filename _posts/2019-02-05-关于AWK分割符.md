---
title: 关于AWK分割符
layout: post
categories: ''
tags: ''
---
#awk作为最常用的文本处理工具

    文本处理主要处理结构化数据

    关于AWK的分割符默认使用空白符（空格、TAB）

    对于经常使用到的时间的分割（-, / 或: ）,IP地址分割(.),ini配置文件的Key和Value分割，以及日志文件中不同值之间的|或~之类
    
    有部分文件或数据的处理需要使用多个分割符进行操作，可以使用正则表达式：
  
    如使用空格和:对某行进行分割[: ]
    
    如使用多个|对某行进行分割[|]+  ---此处表示1个或多个，正则表达式会使用贪婪算法，进行最大配置
    
    对于[yyyy-mm-dd hh24:mi:ss]时间值的读取，可以使用 [][] 作为分割符对某行进行操作，并根据情况结合使用其他字符作为分割符读取相关行不同信息
    
    示例：
    
    将man awk中的相关结果保存到awk.txt文件中，读取有PROCINFO的行，并将方括号中的相关值提取出来
    grep 'PROCINFO\[' awk.txt | awk -F"[][]" '{gsub("[ ]+", "", $1); print $1"||"rand()"||"$2"||"$1"||"$2}'
    
    PROCINFO||23||"egid"||PROCINFO||"egid"
    PROCINFO||29||"euid"||PROCINFO||"euid"
    PROCINFO||84||"FS"||PROCINFO||"FS"
    PROCINFO||15||"gid"||PROCINFO||"gid"
    PROCINFO||58||"identifiers"||PROCINFO||"identifiers"
    PROCINFO||19||"pgrpid"||PROCINFO||"pgrpid"
    PROCINFO||81||"pid"||PROCINFO||"pid"
    PROCINFO||17||"ppid"||PROCINFO||"ppid"
    PROCINFO||48||"strftime"||PROCINFO||"strftime"
    PROCINFO||15||"uid"||PROCINFO||"uid"
    PROCINFO||36||"version"||PROCINFO||"version"
    PROCINFO||49||"api_major"||PROCINFO||"api_major"
    PROCINFO||91||"api_minor"||PROCINFO||"api_minor"
    PROCINFO||26||"gmp_version"||PROCINFO||"gmp_version"
    PROCINFO||89||"mpfr_version"||PROCINFO||"mpfr_version"
    PROCINFO||22||"prec_max"||PROCINFO||"prec_max"
    PROCINFO||63||"prec_min"||PROCINFO||"prec_min"
    PROCINFO||57||"command", "pty"||PROCINFO||"command", "pty"
    PROCINFO||33||"input", "READ_TIMEOUT"||PROCINFO||"input", "READ_TIMEOUT"
    PROCINFO||10||"sorted_in"||PROCINFO||"sorted_in"
    PROCINFO||50||"sorted_in"||PROCINFO||"sorted_in"
    asdescribedinPROCINFO||56||"sorted_in"||asdescribedinPROCINFO||"sorted_in"
    defaultformatisavailableinPROCINFO||85||"strftime"||defaultformatisavailableinPROCINFO||"strftime"
    
    分割上述的结果集并根据相应关进行数据计算
    awk -F '[|]+' '{if($1 == "PROCINFO"){ a[$1]+=$2; b++; } else c++} END {for(i in a) print i, a[i], b, a[i]/b, c}' 2.txt
    PROCINFO 915 21 43.5714 2